<!DOCTYPE html>
<html>
  <head>
    <title>AirbnbLikePg</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag 'https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css' %>
    <%= stylesheet_link_tag 'https://fonts.googleapis.com/icon?family=Material+Icons' %>
    <%= stylesheet_link_tag 'https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css' %>
    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'https://code.jquery.com/jquery-3.2.1.min.js' %>
    <%= javascript_include_tag 'https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js' %>
    <%= javascript_include_tag 'https://cdn.jsdelivr.net/momentjs/latest/moment.min.js' %>
    <%= javascript_include_tag 'https://maps.googleapis.com/maps/api/js?key=AIzaSyDnc0ssO0jI_XbACaOYOBaW74m3YDPti_A&libraries=places' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js' %>
  </head>

  <body>
    <div class="navbar-fixed">

    <%# User dropdown %>
    <ul id="user_submenu" class="dropdown-content">
      <li><%= link_to 'Profile', edit_user_registration_path %></li>
      <li class="divider"></li>
      <li><%= link_to 'My workshops', users_workshops_path %></li>
      <li class="divider"></li>
      <li><%= link_to 'My books (' + Book.select('*').joins('INNER JOIN workshops ON books.workshop_id = workshops.id').where(user_id: current_user.id).all.count.to_s + ')', workshops_books_all_path %></li>
      <li class="divider"></li>
      <li><%= link_to 'Log out', destroy_user_session_path, method: :delete %></li>
    </ul>

    <%# Admin dropdown %>
    <ul id="admin_submenu" class="dropdown-content">
      <li><%= link_to 'Profile', edit_admin_registration_path %></li>
      <li class="divider"></li>
      <li><%= link_to 'Log out', destroy_admin_session_path, method: :delete %></li>
    </ul>
      <nav>
        <div class="nav-wrapper">
          <%= link_to "AirbnbLike", home_path, {:class => "brand-logo"} %>
          <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li>
              <%= form_tag(workshops_search_results_path, method: :get) do %>
                <%= text_field_tag :keyword, params[:keyword], :placeholder => "Rechercher un atelier" %>
              <% end %>
            </li>
            <% if admin_signed_in? %>
              <li>
                <a class="dropdown-button1" href="#!" data-activates="admin_submenu">
                  Admin
                  <i class="material-icons right">arrow_drop_down</i>
                </a>
              </li>
              <li> <%= link_to 'Users', admin_users_path %> </li>
            <% end %>
            <% if user_signed_in? %>
              <li><li><%= link_to 'Create a workshop', new_users_workshop_path %></li></li>
              <li>
                <a class="dropdown-button2" data-activates="user_submenu">
                  <% if current_user.firstname && current_user.lastname %>
                    <%= current_user.firstname %> <%= current_user.lastname %>
                  <% else %>
                    <%= current_user.email %>
                  <% end %>
                  <i class="material-icons right">arrow_drop_down</i>
                </a>
              </li>
            <% else %>
              <% if admin_signed_in?.blank? %>
                <li><%= link_to 'Log in', new_user_session_path %></li>
                <li><%= link_to 'Sign in', new_user_registration_path %></li>
              <% end %>
            <% end %>
          </ul>
        </div>
      </nav>
    </div>

    <div class="container">
      <%= yield %>
    </div>
  </body>
</html>
